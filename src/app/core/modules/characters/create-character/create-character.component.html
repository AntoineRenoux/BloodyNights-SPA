<div bsModal #clanDescriptor="bs-modal" class="modal fade" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title pull-left">{{selectedClan?.name | translate}}
          <ng-container *ngIf="selectedClan?.surname">
            - <i>{{selectedClan?.surname | translate}}</i>
          </ng-container>
        </h2>
        <button type="button" class="btn-close close pull-right" (click)="clanDescriptor.hide()" aria-label="Close">
          <span aria-hidden="true" class="visually-hidden">&times;</span>
        </button>
      </div>
      <div class="modal-body ml-5 mr-5">

        <div *ngIf="selectedClan?.disciplines !== undefined">
          <h2>{{"GAME_DISCIPLINES" | translate}}</h2>
          <div class="row">
            <div class="col text-center" *ngFor="let discipline of selectedClan?.disciplines">
              <strong>{{discipline.name | translate}}</strong>
            </div>
          </div>
        </div>

        <div class="mt-3 mb-3" *ngIf="selectedClan?.history !== undefined && selectedClan?.history?.length > 0">
          <mat-accordion>
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title class="pt-2">
                  <h2>{{"GAME_HISTORY" | translate}}</h2>
                </mat-panel-title>
                <mat-panel-description>
  
                </mat-panel-description>
              </mat-expansion-panel-header>
              <p class="modal-text" [innerHTML]="selectedClan?.history | translate"></p>
            </mat-expansion-panel>
          </mat-accordion>
        </div>

        <div class="mt-3 mb-3" *ngIf="selectedClan?.organization !== undefined && selectedClan?.organization?.length> 0">
          <mat-accordion>
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title class="pt-2">
                  <h2>{{"GAME_ORGANIZATION" | translate}}</h2>
                </mat-panel-title>
                <mat-panel-description>
  
                </mat-panel-description>
              </mat-expansion-panel-header>
              <p class="modal-text" [innerHTML]="selectedClan?.organization | translate"></p>
            </mat-expansion-panel>
          </mat-accordion>
        </div>

        <div class="mt-3 mb-3" *ngIf="selectedClan?.weakness !== undefined && selectedClan?.weakness?.length > 0">
          <mat-accordion>
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title class="pt-2">
                  <h2>{{"GAME_CLAN_WEAKNESS" | translate}}</h2>
                </mat-panel-title>
                <mat-panel-description>
  
                </mat-panel-description>
              </mat-expansion-panel-header>
              <p class="modal-text" [innerHTML]="selectedClan?.weakness | translate"></p>
            </mat-expansion-panel>
          </mat-accordion>
        </div>

        <div class="mt-3 mb-3" *ngIf="selectedClan?.atoutsFlaws !== undefined && selectedClan?.atoutsFlaws?.length > 0">
          <mat-accordion>
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title class="pt-2">
                  <h2>{{"GAME_CLAN_ATOUT" | translate}}</h2>
                </mat-panel-title>
                <mat-panel-description>
  
                </mat-panel-description>
              </mat-expansion-panel-header>
              <div *ngFor="let atout of selectedClan?.atoutsFlaws">
                <strong>{{atout.name | translate}} ({{atout.cost}} points d'atouts) : </strong>
                <span [innerHTML]="atout.description | translate"></span>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </div>

        <div class="mt-2" *ngIf="selectedClan?.bloodlines?.length > 0">
          <h2>{{"CREATE_CHRONICLE_BLOODLINES" | translate}}</h2>
          <div class="row">
            <div class="col" *ngFor="let bl of selectedClan?.bloodlines">
              <button class="w-100" type="button" mat-stroked-button color="primary" (click)="selectedClan = bl;">
                {{bl.name | translate}}
              </button>
            </div>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="col" *ngIf="selectedClan?.parentId">
          <button class="w-100" type="button" mat-stroked-button color="primary"
            (click)="backToMainClan(selectedClan?.parentId)">
            {{'BACK_TO_MAIN_CLAN' | translate}}
          </button>
        </div>
        <div class="col">
          <button class="w-100" type="button" mat-stroked-button color="primary" (click)="selectClan(clanDescriptor);">
            <span *ngIf="selectedClan?.parentId === null">{{'PLAY_THE_CLAN' | translate}}</span>
            <span *ngIf="selectedClan?.parentId">{{'PLAY_THE_BLOODLINE' | translate}}</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid mt-4">
  <div class="row pt-5">
    <bn-helper class="col-2 d-none d-sm-flex position-fixed"></bn-helper>

    <div class="offset-2 col-8">
      <h1>{{"CREATE_CHARACTER" | translate}}</h1>

      <mat-stepper [linear]="true">
        <mat-step [stepControl]="createCharacterStepOneForm" [label]="'FIRST_CHARACTER_CREATION_STEP' | translate">
          <ng-template matStepContent>
            <mat-card class="row">
              <mat-card-title>{{"FIRST_CHARACTER_CREATION_STEP" | translate}}</mat-card-title>
              <mat-card-content class="col mt-3">
                <form [formGroup]="createCharacterStepOneForm" (ngSubmit)="validationStepOne()">

                  <h2>{{'FIRST_CHARACTER_CREATION_STEP_CONCEPT_HEADER' | translate}}</h2>
                  <p>{{'FIRST_CHARACTER_CREATION_STEP_CONCEPT_TEXT' | translate}}</p>
                  <mat-accordion>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          {{'CLICK_HERE_FOR_INFORMATIONS' | translate}}
                        </mat-panel-title>
                        <mat-panel-description>

                        </mat-panel-description>
                      </mat-expansion-panel-header>
                      <p>{{'FIRST_CHARACTER_CREATION_STEP_CONCEPT_TEXT_2' | translate}}</p>
                      <p [innerHTML]="'FIRST_CHARACTER_CREATION_STEP_CONCEPT_TEXT_3' | translate"></p>
                    </mat-expansion-panel>
                  </mat-accordion>

                  <mat-form-field class="w-100 mt-2">
                    <mat-label>{{'FIRST_CHARACTER_CREATION_STEP_CONCEPT' | translate}}</mat-label>
                    <input matInput formControlName="concept" required>
                  </mat-form-field>

                  <h2>{{'FIRST_CHARACTER_CREATION_STEP_ARCHETYPE_HEADER' | translate}}</h2>
                  <p [innerHTML]="'FIRST_CHARACTER_CREATION_STEP_ARCHETYPE_TEXT' | translate"></p>

                  <mat-accordion>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          {{'CLICK_HERE_FOR_INFORMATIONS' | translate}}
                        </mat-panel-title>
                        <mat-panel-description>

                        </mat-panel-description>
                      </mat-expansion-panel-header>
                      <p [innerHTML]="'FIRST_CHARACTER_CREATION_STEP_ARCHETYPE_TEXT_2' | translate"></p>
                      <p [innerHTML]="'FIRST_CHARACTER_CREATION_STEP_ARCHETYPE_TEXT_3' | translate"></p>
                      <ul>
                        <li *ngFor="let archetype of archetypes"><strong>{{archetype.name | translate}} :
                          </strong>{{archetype.description | translate}}</li>
                      </ul>
                    </mat-expansion-panel>
                  </mat-accordion>

                  <mat-form-field class="w-100 mt-2">
                    <mat-label>{{'FIRST_CHARACTER_CREATION_STEP_ARCHETYPE' | translate}}</mat-label>
                    <select matInput matNativeControl formControlName="archetype" required>
                      <option [value]="archetype.name" *ngFor="let archetype of archetypes">{{archetype.name |
                        translate}}
                      </option>
                    </select>
                  </mat-form-field>

                  <div class="col-12 mt-4">
                    <button type="submit" mat-button matStepperNext class="stepper-button"
                      [disabled]="!createCharacterStepOneForm.valid">
                      {{ "NEXT" | translate }}
                    </button>
                  </div>
                </form>
              </mat-card-content>
            </mat-card>
          </ng-template>
        </mat-step>

        <mat-step [stepControl]="createCharacterStepTwoForm" [label]="'SECOND_CHARACTER_CREATION_STEP' | translate">
          <ng-template matStepContent>
            <form [formGroup]="createCharacterStepTwoForm" (ngSubmit)="validationStepTwo()">
              <mat-card>
                <mat-card-title>{{"SECOND_CHARACTER_CREATION_STEP" | translate}}</mat-card-title>
                <mat-card-content class="col mt-3">
                  <p [innerHTML]="'SECOND_CHARACTER_CREATION_STEP_CONCEPT_TEXT' | translate"></p>
                  <p [innerHTML]="'SECOND_CHARACTER_CREATION_STEP_CONCEPT_TEXT_2' | translate"></p>

                  <ng-container *ngIf="currentChronicle !== undefined">
                    <div class="clan-container" *ngFor="let cr of clanService.clanImportances">
                      <div class="clan-importance" [ngSwitch]="cr">
                        <h4 *ngSwitchCase="'MAJOR'">{{"MAJORS_CLANS" | translate}}</h4>
                        <h4 *ngSwitchCase="'MINOR'">{{"MINORS_CLANS" | translate}}</h4>
                        <h4 *ngSwitchCase="'RARE'">{{"RARES_CLANS" | translate}}</h4>
                      </div>
                      <div class="clan-card" *ngFor="let clan of currentChronicle.clans | filterClans : cr">
                        <button class="w-100" type="button" mat-stroked-button color="primary"
                          (click)="selectedClan = clan; clanDescriptor.show()">
                          {{clan.name | translate }}
                        </button>
                      </div>
                    </div>
                  </ng-container>

                </mat-card-content>
                <div class="col">
                  <button type="submit" mat-button matStepperNext class="stepper-button"
                    [disabled]="!createCharacterStepTwoForm.valid">
                    {{ "NEXT" | translate }}
                  </button>
                </div>
              </mat-card>
            </form>
          </ng-template>
        </mat-step>

        <mat-step [stepControl]="createCharacterStepThreeForm" [label]="'STEP_3_CHOOSE_INITIAL_ATTRIBUTS' | translate">
          <ng-template matStepContent>
            <form [formGroup]="createCharacterStepThreeForm">
              <mat-card>
                <mat-card-title>{{"STEP_3_CHOOSE_INITIAL_ATTRIBUTS" | translate}}</mat-card-title>
                <mat-card-content class="col mt-3">
                  <p [innerHTML]="'STEP_3_CHOOSE_INITIAL_ATTRIBUTS_EXPLAIN_HEADER' | translate"></p>
                  <p [innerHTML]="'STEP_3_CHOOSE_INITIAL_ATTRIBUTS_EXPLAIN_TEXT' | translate"></p>

                  <div class="row">
                    <div class="col">
                      <mat-form-field class="w-100">
                        <mat-label>{{'STEP_3_PHYSICAL_ATTRIBUTE_HEADER' | translate}}</mat-label>
                        <input type="number" matInput [formControlName]="physical" required placeholder="Ex : 10">
                      </mat-form-field>
                    </div>

                    <divv class="col">
                      <mat-form-field class="w-100">
                        <mat-label>{{'STEP_3_SOCIAL_ATTRIBUTE_HEADER' | translate}}</mat-label>
                        <input type="number" matInput [formControlName]="social" required placeholder="Ex : 7">
                      </mat-form-field>
                    </divv>

                    <div class="col">
                      <mat-form-field class="w-100">
                        <mat-label>{{'STEP_3_MENTAL_ATTRIBUTE_HEADER' | translate}}</mat-label>
                        <input type="number" matInput [formControlName]="mental" required placeholder="Ex : 3">
                      </mat-form-field>
                    </div>
                  </div>
                </mat-card-content>
                <div class="col">
                  <button type="submit" mat-button matStepperNext class="stepper-button"
                    [disabled]="!createCharacterStepThreeForm.valid">
                    {{ "NEXT" | translate }}
                  </button>
                </div>
              </mat-card>
            </form>
          </ng-template>
        </mat-step>

      </mat-stepper>
    </div>

    <bn-stepper [stepperType]="'characterCreation'"
      class="offset-10 col-2 d-none d-sm-flex position-fixed"></bn-stepper>
  </div>
</div>